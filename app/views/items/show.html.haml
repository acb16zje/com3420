- content_for :title, "#{@item.name}"

%section.section
  .container.is-desktop
    - if not notice.nil?
      .columns
        .column.is-4.is-offset-4
          .notification.is-success.has-text-centered
            %button.delete
            = notice
    .box
      .columns
        - if @item.image?
          .column.is-5.has-text-centered#zoom{style: 'margin: auto'}
            = image_tag(@item.image.url, alt: 'Image')
        -else
          .column.is-5.has-text-centered{style: 'margin: auto'}
            = image_tag("amrc.svg", width: "250", alt: 'Default Image, AMRC')
        .column
          %table.table.is-bordered.is-striped.is-fullwidth
            %tbody
              %tr
                %th Owner
                %td
                  - user = User.find_by_id(@item.user_id)
                  = user.givenname.to_s + ' ' + user.sn.to_s
              %tr
                %th Name
                %td
                  = @item.name
              %tr
                %th Serial ID
                %td
                  = @item.serial_id
              %tr
                %th Manufacturer
                %td
                  = @item.manufacturer
              %tr
                %th Model
                %td
                  = @item.model
              %tr
                %th Category
                %td
                  = @item.category.name
              %tr
                %th Serial
                %td
                  = @item.serial
              %tr
                %th Aquisition Date
                %td
                  = @item.acquisition_date
              %tr
                %th Purchase Price
                %td
                  = "Â£ " + @item.purchase_price.to_s
              %tr
                %th Condition
                %td
                  - case @item.condition
                  - when 'Like New'
                    %span.tag.is-success.is-medium
                      = @item.condition
                  - when 'Good'
                    %span.tag.is-primary.is-medium
                      = @item.condition
                  - when 'Adequate'
                    %span.tag.is-warning.is-medium
                      = @item.condition
                  - when 'Damaged'
                    %span.tag.is-danger.is-medium
                      = @item.condition
                  - when 'Missing'
                    %span.tag.is-danger.is-medium
                      = @item.condition
                  - else
                    %span.tag.is-black.is-medium
                      Unknown
              %tr
                %th Location
                %td
                  = @item.location
              %tr
                -#%th Peripherals
                -#  %td
                -#    = @item.peripherals

      .field.is-horizontal
        .field-body
          - if current_user.permission_id > 1
            .field.is-grouped.is-grouped-left
              .control
                = link_to 'Edit', edit_item_path(@item), class: 'button is-link', id: "edit_item_#{@item.id}"
          .field.is-grouped.is-grouped-right
            .control
              = link_to 'Back', items_path, class: 'button is-block is-light'
            .control
              = link_to 'Book or Reserve', new_item_booking_path(item_id: @item.id), class:'button is-link is-block'

    %br
    %br
    - if @item.user_id == current_user.id || current_user.permission_id == 3
      %p.title.has-text-centered Bookings History
      %table#bookings.table.is-striped.is-bordered{:cellspacing => "0", :width => "100%"}
        %thead
          %tr
            %th Booking ID
            %th Asset
            %th Start Date
            %th Start Time
            %th End Date
            %th End Time
            %th Booked By
            %th Status
        %tbody
          - @bookings.each do |booking|
            %tr
              %td.has-text-centered= booking.id
              %td.has-text-centered= @item.name
              %td.has-text-centered= booking.start_date
              %td.has-text-centered= booking.start_time.strftime("%I:%M %p")
              %td.has-text-centered= booking.end_date
              %td.has-text-centered= booking.end_time.strftime("%I:%M %p")
              %td.has-text-centered= link_to booking.user.givenname, booking.user
              %td.has-text-centered
                - case booking.status
                - when 1
                  %span.tag.is-warning.is-medium
                    Pending
                - when 2
                  %span.tag.is-success.is-medium
                    Accepted
                - when 3
                  %span.tag.is-info.is-medium
                    Ongoing
                - when 4
                  %span.tag.is-success.is-medium
                    Completed
                - when 5
                  %span.tag.is-danger.is-medium
                    Rejected
                - when 6
                  %span.tag.is-danger.is-medium
                    Cancelled
                - when 7
                  %span.tag.is-danger.is-medium
                    Late