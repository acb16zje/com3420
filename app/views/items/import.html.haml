- content_for :title, "Create category"

%section.hero
  .hero-body
    .container.has-text-centered
      - flash.each do |name, msg|
        - next unless name == 'alert' || name == 'notice'
        .columns
          .column.is-4.is-offset-4
            .notification.is-danger.has-text-centered
              %button.delete
              = msg

      .column.is-10.is-offset-1
        %h3.title Create category
        .box
          = simple_form_for :import_file, url: import_file_items_path, html: { multipart: true } do |f|
            = f.error_notification

            .field.is-horizontal
              .field-label.is-normal
              .field-body
                .field
                  %p.control.is-expanded                      
                    = f.input :file, as: :file, label: false, input_html: {type: 'file', accept: '.xlsx'}
            %br
            .field.is-horizontal
              .field-label.has-text-left
                -#Left empty for spacing
              .field-body
                .field.is-grouped.is-grouped-right
                  .control
                    = link_to 'Cancel' , root_path, class: 'button is-block is-light'
                  .control
                    = f.submit 'Import assets', class: 'button is-block is-link'
      - if !params[:incorrect_rows].blank?
        %br
        %br
        %br
        %br
        %p.title.has-text-centered Import Errors
        %table#categories.table.is-striped.is-bordered{:cellspacing => "0", :width => "100%"}
          %thead
            %tr
              %th Row
              %th Error
          %tbody
            - params[:incorrect_rows].each do |row|
              %tr
                %td.has-text-centered
                  = row[0].split(",").first.to_i + 1
                  -# = row
                %td.has-text-centered
                  - case row[0].split(",").last.to_i
                  - when 0
                    This row's NAME cell is either empty or does not follow the correct format
                  - when 1
                    This row's SERIAL cell is either empty or does not follow the correct format
                  - when 2
                    This row's SERIAL cell already exists in the database and is not unique
                  - when 3
                    This row's SERIAL cell is empty
                  - when 4
                    This row's CATEGORY cell does not exist in the database
                  - when 5
                    This row's CONDITION cell is either empty or does not follow the correct format
                  - when 6
                    This row's ACQUISITION_DATE cell is either empty or does not follow the correct format
                  - when 7
                    This row's PURCHASE_PRICE cell does not follow the correct format
                  - when 8
                    This row's LOCATION cell does not follow the correct format
                  - when 9
                    This row's MANUFACTURER cell does not follow the correct format
                  - when 10
                    This row's MODEL cell does not follow the correct format
                  - when 11
                    This row's PARENT_ASSET_SERIAL cell does not exist in the database
                  - when 12
                    This row's RETIRED_DATE cell either does not follow the correct format or CONDITION is not set to Retired
                  - when 13
                    This row's PO_NUMBER cell is either empty or does not follow the correct format
                  - when 14
                    This row's COMMENT cell is either empty or does not follow the correct format
                  - else
                    Unknown